<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hd.api.dao.OptLogMapper">
  <resultMap id="BaseResultMap" type="OptLog">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <constructor>
      <idArg column="LogId" javaType="java.lang.String" jdbcType="CHAR" />
      <arg column="AppName" javaType="java.lang.String" jdbcType="NVARCHAR" />
      <arg column="LogType" javaType="java.lang.Integer" jdbcType="INTEGER" />
      <arg column="RequestIp" javaType="java.lang.String" jdbcType="NVARCHAR" />
      <arg column="RequestUri" javaType="java.lang.String" jdbcType="NVARCHAR" />
      <arg column="RequestMethod" javaType="java.lang.String" jdbcType="NVARCHAR" />
      <arg column="RequestParams" javaType="java.lang.String" jdbcType="NVARCHAR" />
      <arg column="MethodName" javaType="java.lang.String" jdbcType="NVARCHAR" />
      <arg column="MethodDesc" javaType="java.lang.String" jdbcType="NVARCHAR" />
      <arg column="ExceptionCode" javaType="java.lang.String" jdbcType="NVARCHAR" />
      <arg column="CreateUser" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="CreateTime" javaType="java.util.Date" jdbcType="TIMESTAMP" />
      <arg column="ResponseStatus" javaType="java.lang.String" jdbcType="NVARCHAR" />
      <arg column="ResponseContent" javaType="java.lang.String" jdbcType="NVARCHAR" />
    </constructor>
  </resultMap>
  <resultMap id="ResultMapWithBLOBs" type="OptLog">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <constructor>
      <idArg column="LogId" javaType="java.lang.String" jdbcType="CHAR" />
      <arg column="AppName" javaType="java.lang.String" jdbcType="NVARCHAR" />
      <arg column="LogType" javaType="java.lang.Integer" jdbcType="INTEGER" />
      <arg column="RequestIp" javaType="java.lang.String" jdbcType="NVARCHAR" />
      <arg column="RequestUri" javaType="java.lang.String" jdbcType="NVARCHAR" />
      <arg column="RequestMethod" javaType="java.lang.String" jdbcType="NVARCHAR" />
      <arg column="RequestParams" javaType="java.lang.String" jdbcType="NVARCHAR" />
      <arg column="MethodName" javaType="java.lang.String" jdbcType="NVARCHAR" />
      <arg column="MethodDesc" javaType="java.lang.String" jdbcType="NVARCHAR" />
      <arg column="ExceptionCode" javaType="java.lang.String" jdbcType="NVARCHAR" />
      <arg column="CreateUser" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="CreateTime" javaType="java.util.Date" jdbcType="TIMESTAMP" />
      <arg column="ResponseStatus" javaType="java.lang.String" jdbcType="NVARCHAR" />
      <arg column="ResponseContent" javaType="java.lang.String" jdbcType="NVARCHAR" />
      <arg column="ExceptionDetail" javaType="java.lang.String" jdbcType="LONGVARCHAR" />
    </constructor>
  </resultMap>
  
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    LogId, AppName, LogType, RequestIp, RequestUri, RequestMethod, RequestParams, MethodName, 
    MethodDesc, ExceptionCode, CreateUser, CreateTime, ResponseStatus, ResponseContent
  </sql>
  <sql id="Blob_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    ExceptionDetail
  </sql>
  
  <!-- 自定义   -->
  <select id="selectFunStatsByUserId" resultType="FunStatsDTO">
  SELECT
    COUNT (1) cou ,
        MethodDesc dsc
    FROM
        OptLog
    WHERE
        CreateUser = #{userId}
        <if test="startTime != null and startTime != ''" >
          And  CreateTime &gt;= #{startTime}
        </if>
        <if test="endTim != null and endTim != ''" >
          And  CreateTime &lt;= #{endTim}
        </if>
    GROUP BY
        MethodDesc
    ORDER BY cou desc
  </select>
  
  <select id="selectFeatureVisitor" resultType="FunStatsDTO">
    SELECT COUNT(1) cou,MethodDesc dsc 
    FROM  OptLog
	  <where> 
	    <if test="methodName != null and methodName != ''" >
	        MethodName = #{methodName}
	    </if> 
	    <if test="methodDesc != null and methodDesc != ''" >
	      And  MethodDesc = #{methodDesc}
	    </if>
		<if test="startTime != null and startTime != ''" >
	      And  CreateTime &gt;= #{startTime}
	    </if>
		<if test="endTim != null and endTim != ''" >
	      And  CreateTime &lt;= #{endTim}
	    </if>
	  </where>
	  GROUP BY
        MethodDesc
	  ORDER BY
		cou DESC
  </select>
</mapper>